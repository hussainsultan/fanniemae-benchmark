import duckdb

if __name__ == "__main__":
    conn = duckdb.connect()
#    conn.execute(
#        """ COPY (SELECT * from read_csv_auto('../data/raw/perf/Performance*.txt*', 
#     columns = { 'loan_id': 'BIGINT',
#     'monthly_reporting_period' : 'VARCHAR',
#     'servicer': 'VARCHAR',
#     'interest_rate': 'DOUBLE',
#     'current_actual_upb':'DOUBLE',
#     'loan_age': 'SMALLINT',
#     'remaining_months_to_legal_maturity': 'DOUBLE',
#     'adj_remaining_months_to_maturity': 'DOUBLE',
#     'maturity_date': 'VARCHAR',
#     'msa': 'DOUBLE',
#     'current_loan_delinquency_status': 'SMALLINT',
#     'mod_flag': 'VARCHAR',
#     'zero_balance_code': 'VARCHAR',
#     'zero_balance_effective_date': 'VARCHAR',
#     'last_paid_installment_date': 'VARCHAR',
#     'foreclosed_after': 'VARCHAR',
#     'disposition_date': 'VARCHAR',
#     'foreclosure_costs': 'INTEGER',
#     'prop_preservation_and_reair_costs': 'DOUBLE',
#     'asset_recovery_costs': 'DOUBLE',
#     'misc_holding_expenses': 'DOUBLE',
#     'holding_taxes': 'DOUBLE',
#     'net_sale_proceeds': 'DOUBLE',
#     'credit_enhancement_proceeds': 'DOUBLE',
#     'repurchase_make_whole_proceeds': 'DOUBLE',
#     'other_foreclosure_proceeds': 'DOUBLE',
#     'non_interest_bearing_upb': 'DOUBLE',
#     'principal_forgiveness_upb': 'VARCHAR',
#     'repurchase_make_whole_proceeds_flag': 'VARCHAR',
#     'foreclosure_principal_write_off_amount': 'VARCHAR',
#     'servicing_activity_indicator': 'VARCHAR' })) TO '../data/perf.parquet' (FORMAT 'parquet'); """
#    )
#
    conn.execute(
        query=""" COPY ( SELECT * FROM read_csv_auto('../data/raw/acq/*.txt*',
    columns={'loan_id': 'int64',
         'orig_channel': 'str',
         'seller_name': 'str',
         'orig_interest_rate': 'float64',
         'orig_upb': 'int64',
         'orig_loan_term': 'int64',
         'orig_date': 'datetime64[ms]',
         'first_pay_date': 'datetime64[ms]',
         'orig_ltv': 'float64',
         'orig_cltv': 'float64',
         'num_borrowers': 'float64',
         'dti': 'float64',
         'borrower_credit_score': 'float64',
         'first_home_buyer': 'str',
         'loan_purpose': 'str',
         'property_type': 'str',
         'num_units': 'int64',
         'occupancy_status': 'str',
         'property_state': 'str',
         'zip': 'int64',
         'mortgage_insurance_percent': 'float64',
         'product_type': 'str',
         'coborrow_credit_score': 'float64',
         'mortgage_insurance_type': 'float64',
         'relocation_mortgage_indicator': 'str'})) TO '../data/acq.parquet' (FORMAT 'parquet');"""
    )
