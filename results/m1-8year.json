[{"machine": "arm64", "version": "Darwin Kernel Version 21.2.0: Sun Nov 28 20:29:10 PST 2021; root:xnu-8019.61.5~1/RELEASE_ARM64_T8101", "platform": "macOS-12.1-arm64-arm-64bit", "system": "Darwin", "cpu_count": 8, "memory": 17179869184, "processor": "arm", "threads": 2, "run_date": "29/03/2022 12:21:10", "total_time": 468.9351658821106, "row_count_perf": 1124692412, "row_count_acq": 19144929, "max_memory_usage": 1731.0, "incremental_memory_usage": 727.140625, "sql": "WITH performance AS ( SELECT perf.loan_id, book.orig_date, perf.loan_age AS stmt_number, book.borrower_credit_score, perf.disposition_date, perf.current_actual_upb, strftime( strptime(perf.monthly_reporting_period, '%Y-%d-%m'), '%Y-%m' ) AS report_month, CASE WHEN perf.current_loan_delinquency_status > 1 THEN 1 ELSE 0 END AS dq30, CASE WHEN perf.current_loan_delinquency_status > 3 THEN 1 ELSE 0 END AS dq90, CASE WHEN perf.current_loan_delinquency_status > 6 THEN 1 ELSE 0 END AS dq180, CASE WHEN perf.zero_balance_code = '02' THEN 1 WHEN perf.zero_balance_code = '03' THEN 1 WHEN perf.zero_balance_code = '09' THEN 1 WHEN perf.zero_balance_code = '15' THEN 1 ELSE 0 END AS bad FROM \"eight/perf/*.parquet\" AS perf, ( SELECT loan_id, borrower_credit_score, str_split(orig_date, '/')[1] AS orig_date FROM \"eight/acq/*.parquet\" ) AS book WHERE perf.loan_id = book.loan_id ) SELECT agg.orig_date, agg.stmt_number, loans.loan_count, agg.avg_credit_score, agg.upb_sum, agg.dollar_bad FROM (SELECT orig_date, stmt_number, avg(borrower_credit_score) AS avg_credit_score, sum(CASE WHEN disposition_date IS NOT NULL THEN current_actual_upb ELSE 0 END) AS dollar_bad, sum(current_actual_upb) AS upb_sum FROM performance WHERE stmt_number >= 1 GROUP BY orig_date, stmt_number) AS agg, (SELECT str_split(orig_date, '/')[1] AS orig_year, count(loan_id) AS loan_count FROM \"eight/acq/*.parquet\" GROUP BY orig_year) AS loans WHERE agg.orig_date = loans.orig_year;"}, {"machine": "arm64", "version": "Darwin Kernel Version 21.2.0: Sun Nov 28 20:29:10 PST 2021; root:xnu-8019.61.5~1/RELEASE_ARM64_T8101", "platform": "macOS-12.1-arm64-arm-64bit", "system": "Darwin", "cpu_count": 8, "memory": 17179869184, "processor": "arm", "threads": 4, "run_date": "29/03/2022 12:25:12", "total_time": 242.22843527793884, "row_count_perf": 1124692412, "row_count_acq": 19144929, "max_memory_usage": 1795.0, "incremental_memory_usage": 429.03125, "sql": "WITH performance AS ( SELECT perf.loan_id, book.orig_date, perf.loan_age AS stmt_number, book.borrower_credit_score, perf.disposition_date, perf.current_actual_upb, strftime( strptime(perf.monthly_reporting_period, '%Y-%d-%m'), '%Y-%m' ) AS report_month, CASE WHEN perf.current_loan_delinquency_status > 1 THEN 1 ELSE 0 END AS dq30, CASE WHEN perf.current_loan_delinquency_status > 3 THEN 1 ELSE 0 END AS dq90, CASE WHEN perf.current_loan_delinquency_status > 6 THEN 1 ELSE 0 END AS dq180, CASE WHEN perf.zero_balance_code = '02' THEN 1 WHEN perf.zero_balance_code = '03' THEN 1 WHEN perf.zero_balance_code = '09' THEN 1 WHEN perf.zero_balance_code = '15' THEN 1 ELSE 0 END AS bad FROM \"eight/perf/*.parquet\" AS perf, ( SELECT loan_id, borrower_credit_score, str_split(orig_date, '/')[1] AS orig_date FROM \"eight/acq/*.parquet\" ) AS book WHERE perf.loan_id = book.loan_id ) SELECT agg.orig_date, agg.stmt_number, loans.loan_count, agg.avg_credit_score, agg.upb_sum, agg.dollar_bad FROM (SELECT orig_date, stmt_number, avg(borrower_credit_score) AS avg_credit_score, sum(CASE WHEN disposition_date IS NOT NULL THEN current_actual_upb ELSE 0 END) AS dollar_bad, sum(current_actual_upb) AS upb_sum FROM performance WHERE stmt_number >= 1 GROUP BY orig_date, stmt_number) AS agg, (SELECT str_split(orig_date, '/')[1] AS orig_year, count(loan_id) AS loan_count FROM \"eight/acq/*.parquet\" GROUP BY orig_year) AS loans WHERE agg.orig_date = loans.orig_year;"}, {"machine": "arm64", "version": "Darwin Kernel Version 21.2.0: Sun Nov 28 20:29:10 PST 2021; root:xnu-8019.61.5~1/RELEASE_ARM64_T8101", "platform": "macOS-12.1-arm64-arm-64bit", "system": "Darwin", "cpu_count": 8, "memory": 17179869184, "processor": "arm", "threads": 6, "run_date": "29/03/2022 12:28:30", "total_time": 198.31775212287903, "row_count_perf": 1124692412, "row_count_acq": 19144929, "max_memory_usage": 1850.8125, "incremental_memory_usage": 54.734375, "sql": "WITH performance AS ( SELECT perf.loan_id, book.orig_date, perf.loan_age AS stmt_number, book.borrower_credit_score, perf.disposition_date, perf.current_actual_upb, strftime( strptime(perf.monthly_reporting_period, '%Y-%d-%m'), '%Y-%m' ) AS report_month, CASE WHEN perf.current_loan_delinquency_status > 1 THEN 1 ELSE 0 END AS dq30, CASE WHEN perf.current_loan_delinquency_status > 3 THEN 1 ELSE 0 END AS dq90, CASE WHEN perf.current_loan_delinquency_status > 6 THEN 1 ELSE 0 END AS dq180, CASE WHEN perf.zero_balance_code = '02' THEN 1 WHEN perf.zero_balance_code = '03' THEN 1 WHEN perf.zero_balance_code = '09' THEN 1 WHEN perf.zero_balance_code = '15' THEN 1 ELSE 0 END AS bad FROM \"eight/perf/*.parquet\" AS perf, ( SELECT loan_id, borrower_credit_score, str_split(orig_date, '/')[1] AS orig_date FROM \"eight/acq/*.parquet\" ) AS book WHERE perf.loan_id = book.loan_id ) SELECT agg.orig_date, agg.stmt_number, loans.loan_count, agg.avg_credit_score, agg.upb_sum, agg.dollar_bad FROM (SELECT orig_date, stmt_number, avg(borrower_credit_score) AS avg_credit_score, sum(CASE WHEN disposition_date IS NOT NULL THEN current_actual_upb ELSE 0 END) AS dollar_bad, sum(current_actual_upb) AS upb_sum FROM performance WHERE stmt_number >= 1 GROUP BY orig_date, stmt_number) AS agg, (SELECT str_split(orig_date, '/')[1] AS orig_year, count(loan_id) AS loan_count FROM \"eight/acq/*.parquet\" GROUP BY orig_year) AS loans WHERE agg.orig_date = loans.orig_year;"}, {"machine": "arm64", "version": "Darwin Kernel Version 21.2.0: Sun Nov 28 20:29:10 PST 2021; root:xnu-8019.61.5~1/RELEASE_ARM64_T8101", "platform": "macOS-12.1-arm64-arm-64bit", "system": "Darwin", "cpu_count": 8, "memory": 17179869184, "processor": "arm", "threads": 8, "run_date": "29/03/2022 12:30:33", "total_time": 122.75096607208252, "row_count_perf": 1124692412, "row_count_acq": 19144929, "max_memory_usage": 1905.171875, "incremental_memory_usage": 177.453125, "sql": "WITH performance AS ( SELECT perf.loan_id, book.orig_date, perf.loan_age AS stmt_number, book.borrower_credit_score, perf.disposition_date, perf.current_actual_upb, strftime( strptime(perf.monthly_reporting_period, '%Y-%d-%m'), '%Y-%m' ) AS report_month, CASE WHEN perf.current_loan_delinquency_status > 1 THEN 1 ELSE 0 END AS dq30, CASE WHEN perf.current_loan_delinquency_status > 3 THEN 1 ELSE 0 END AS dq90, CASE WHEN perf.current_loan_delinquency_status > 6 THEN 1 ELSE 0 END AS dq180, CASE WHEN perf.zero_balance_code = '02' THEN 1 WHEN perf.zero_balance_code = '03' THEN 1 WHEN perf.zero_balance_code = '09' THEN 1 WHEN perf.zero_balance_code = '15' THEN 1 ELSE 0 END AS bad FROM \"eight/perf/*.parquet\" AS perf, ( SELECT loan_id, borrower_credit_score, str_split(orig_date, '/')[1] AS orig_date FROM \"eight/acq/*.parquet\" ) AS book WHERE perf.loan_id = book.loan_id ) SELECT agg.orig_date, agg.stmt_number, loans.loan_count, agg.avg_credit_score, agg.upb_sum, agg.dollar_bad FROM (SELECT orig_date, stmt_number, avg(borrower_credit_score) AS avg_credit_score, sum(CASE WHEN disposition_date IS NOT NULL THEN current_actual_upb ELSE 0 END) AS dollar_bad, sum(current_actual_upb) AS upb_sum FROM performance WHERE stmt_number >= 1 GROUP BY orig_date, stmt_number) AS agg, (SELECT str_split(orig_date, '/')[1] AS orig_year, count(loan_id) AS loan_count FROM \"eight/acq/*.parquet\" GROUP BY orig_year) AS loans WHERE agg.orig_date = loans.orig_year;"}]
