[{"machine": "arm64", "version": "Darwin Kernel Version 21.2.0: Sun Nov 28 20:29:10 PST 2021; root:xnu-8019.61.5~1/RELEASE_ARM64_T8101", "platform": "macOS-12.1-arm64-arm-64bit", "system": "Darwin", "cpu_count": 8, "memory": 17179869184, "processor": "arm", "threads": 2, "run_date": "28/03/2022 20:54:46", "total_time": 2404.6131160259247, "row_count_perf": 681894031, "row_count_acq": 19144929, "max_memory_usage": 1722.15625, "incremental_memory_usage": 598.890625, "sql": "WITH performance AS ( SELECT perf.loan_id, book.orig_date, perf.loan_age AS stmt_number, book.borrower_credit_score, perf.disposition_date, perf.current_actual_upb, strftime( strptime(perf.monthly_reporting_period, '%Y-%d-%m'), '%Y-%m' ) AS report_month, CASE WHEN perf.current_loan_delinquency_status > 1 THEN 1 ELSE 0 END AS dq30, CASE WHEN perf.current_loan_delinquency_status > 3 THEN 1 ELSE 0 END AS dq90, CASE WHEN perf.current_loan_delinquency_status > 6 THEN 1 ELSE 0 END AS dq180, CASE WHEN perf.zero_balance_code = '02' THEN 1 WHEN perf.zero_balance_code = '03' THEN 1 WHEN perf.zero_balance_code = '09' THEN 1 WHEN perf.zero_balance_code = '15' THEN 1 ELSE 0 END AS bad FROM \"co8/perf/*.parquet\" AS perf, ( SELECT loan_id, borrower_credit_score, str_split(orig_date, '/')[1] AS orig_date FROM \"co8/acq/*.parquet\" ) AS book WHERE perf.loan_id = book.loan_id ) SELECT agg.orig_date, agg.stmt_number, loans.loan_count, agg.avg_credit_score, agg.upb_sum, agg.dollar_bad FROM (SELECT orig_date, stmt_number, avg(borrower_credit_score) AS avg_credit_score, sum(CASE WHEN disposition_date IS NOT NULL THEN current_actual_upb ELSE 0 END) AS dollar_bad, sum(current_actual_upb) AS upb_sum FROM performance WHERE stmt_number >= 1 GROUP BY orig_date, stmt_number) AS agg, (SELECT str_split(orig_date, '/')[1] AS orig_year, count(loan_id) AS loan_count FROM \"co8/acq/*.parquet\" GROUP BY orig_year) AS loans WHERE agg.orig_date = loans.orig_year;"}, {"machine": "arm64", "version": "Darwin Kernel Version 21.2.0: Sun Nov 28 20:29:10 PST 2021; root:xnu-8019.61.5~1/RELEASE_ARM64_T8101", "platform": "macOS-12.1-arm64-arm-64bit", "system": "Darwin", "cpu_count": 8, "memory": 17179869184, "processor": "arm", "threads": 4, "run_date": "28/03/2022 20:56:27", "total_time": 101.13248205184937, "row_count_perf": 681894031, "row_count_acq": 19144929, "max_memory_usage": 1886.640625, "incremental_memory_usage": 279.140625, "sql": "WITH performance AS ( SELECT perf.loan_id, book.orig_date, perf.loan_age AS stmt_number, book.borrower_credit_score, perf.disposition_date, perf.current_actual_upb, strftime( strptime(perf.monthly_reporting_period, '%Y-%d-%m'), '%Y-%m' ) AS report_month, CASE WHEN perf.current_loan_delinquency_status > 1 THEN 1 ELSE 0 END AS dq30, CASE WHEN perf.current_loan_delinquency_status > 3 THEN 1 ELSE 0 END AS dq90, CASE WHEN perf.current_loan_delinquency_status > 6 THEN 1 ELSE 0 END AS dq180, CASE WHEN perf.zero_balance_code = '02' THEN 1 WHEN perf.zero_balance_code = '03' THEN 1 WHEN perf.zero_balance_code = '09' THEN 1 WHEN perf.zero_balance_code = '15' THEN 1 ELSE 0 END AS bad FROM \"co8/perf/*.parquet\" AS perf, ( SELECT loan_id, borrower_credit_score, str_split(orig_date, '/')[1] AS orig_date FROM \"co8/acq/*.parquet\" ) AS book WHERE perf.loan_id = book.loan_id ) SELECT agg.orig_date, agg.stmt_number, loans.loan_count, agg.avg_credit_score, agg.upb_sum, agg.dollar_bad FROM (SELECT orig_date, stmt_number, avg(borrower_credit_score) AS avg_credit_score, sum(CASE WHEN disposition_date IS NOT NULL THEN current_actual_upb ELSE 0 END) AS dollar_bad, sum(current_actual_upb) AS upb_sum FROM performance WHERE stmt_number >= 1 GROUP BY orig_date, stmt_number) AS agg, (SELECT str_split(orig_date, '/')[1] AS orig_year, count(loan_id) AS loan_count FROM \"co8/acq/*.parquet\" GROUP BY orig_year) AS loans WHERE agg.orig_date = loans.orig_year;"}, {"machine": "arm64", "version": "Darwin Kernel Version 21.2.0: Sun Nov 28 20:29:10 PST 2021; root:xnu-8019.61.5~1/RELEASE_ARM64_T8101", "platform": "macOS-12.1-arm64-arm-64bit", "system": "Darwin", "cpu_count": 8, "memory": 17179869184, "processor": "arm", "threads": 6, "run_date": "28/03/2022 20:57:55", "total_time": 88.06658506393433, "row_count_perf": 681894031, "row_count_acq": 19144929, "max_memory_usage": 1961.265625, "incremental_memory_usage": 324.125, "sql": "WITH performance AS ( SELECT perf.loan_id, book.orig_date, perf.loan_age AS stmt_number, book.borrower_credit_score, perf.disposition_date, perf.current_actual_upb, strftime( strptime(perf.monthly_reporting_period, '%Y-%d-%m'), '%Y-%m' ) AS report_month, CASE WHEN perf.current_loan_delinquency_status > 1 THEN 1 ELSE 0 END AS dq30, CASE WHEN perf.current_loan_delinquency_status > 3 THEN 1 ELSE 0 END AS dq90, CASE WHEN perf.current_loan_delinquency_status > 6 THEN 1 ELSE 0 END AS dq180, CASE WHEN perf.zero_balance_code = '02' THEN 1 WHEN perf.zero_balance_code = '03' THEN 1 WHEN perf.zero_balance_code = '09' THEN 1 WHEN perf.zero_balance_code = '15' THEN 1 ELSE 0 END AS bad FROM \"co8/perf/*.parquet\" AS perf, ( SELECT loan_id, borrower_credit_score, str_split(orig_date, '/')[1] AS orig_date FROM \"co8/acq/*.parquet\" ) AS book WHERE perf.loan_id = book.loan_id ) SELECT agg.orig_date, agg.stmt_number, loans.loan_count, agg.avg_credit_score, agg.upb_sum, agg.dollar_bad FROM (SELECT orig_date, stmt_number, avg(borrower_credit_score) AS avg_credit_score, sum(CASE WHEN disposition_date IS NOT NULL THEN current_actual_upb ELSE 0 END) AS dollar_bad, sum(current_actual_upb) AS upb_sum FROM performance WHERE stmt_number >= 1 GROUP BY orig_date, stmt_number) AS agg, (SELECT str_split(orig_date, '/')[1] AS orig_year, count(loan_id) AS loan_count FROM \"co8/acq/*.parquet\" GROUP BY orig_year) AS loans WHERE agg.orig_date = loans.orig_year;"}, {"machine": "arm64", "version": "Darwin Kernel Version 21.2.0: Sun Nov 28 20:29:10 PST 2021; root:xnu-8019.61.5~1/RELEASE_ARM64_T8101", "platform": "macOS-12.1-arm64-arm-64bit", "system": "Darwin", "cpu_count": 8, "memory": 17179869184, "processor": "arm", "threads": 8, "run_date": "28/03/2022 20:59:09", "total_time": 74.05064988136292, "row_count_perf": 681894031, "row_count_acq": 19144929, "max_memory_usage": 1946.453125, "incremental_memory_usage": 107.84375, "sql": "WITH performance AS ( SELECT perf.loan_id, book.orig_date, perf.loan_age AS stmt_number, book.borrower_credit_score, perf.disposition_date, perf.current_actual_upb, strftime( strptime(perf.monthly_reporting_period, '%Y-%d-%m'), '%Y-%m' ) AS report_month, CASE WHEN perf.current_loan_delinquency_status > 1 THEN 1 ELSE 0 END AS dq30, CASE WHEN perf.current_loan_delinquency_status > 3 THEN 1 ELSE 0 END AS dq90, CASE WHEN perf.current_loan_delinquency_status > 6 THEN 1 ELSE 0 END AS dq180, CASE WHEN perf.zero_balance_code = '02' THEN 1 WHEN perf.zero_balance_code = '03' THEN 1 WHEN perf.zero_balance_code = '09' THEN 1 WHEN perf.zero_balance_code = '15' THEN 1 ELSE 0 END AS bad FROM \"co8/perf/*.parquet\" AS perf, ( SELECT loan_id, borrower_credit_score, str_split(orig_date, '/')[1] AS orig_date FROM \"co8/acq/*.parquet\" ) AS book WHERE perf.loan_id = book.loan_id ) SELECT agg.orig_date, agg.stmt_number, loans.loan_count, agg.avg_credit_score, agg.upb_sum, agg.dollar_bad FROM (SELECT orig_date, stmt_number, avg(borrower_credit_score) AS avg_credit_score, sum(CASE WHEN disposition_date IS NOT NULL THEN current_actual_upb ELSE 0 END) AS dollar_bad, sum(current_actual_upb) AS upb_sum FROM performance WHERE stmt_number >= 1 GROUP BY orig_date, stmt_number) AS agg, (SELECT str_split(orig_date, '/')[1] AS orig_year, count(loan_id) AS loan_count FROM \"co8/acq/*.parquet\" GROUP BY orig_year) AS loans WHERE agg.orig_date = loans.orig_year;"}]
