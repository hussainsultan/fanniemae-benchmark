[{"machine": "arm64", "version": "Darwin Kernel Version 21.2.0: Sun Nov 28 20:29:10 PST 2021; root:xnu-8019.61.5~1/RELEASE_ARM64_T8101", "platform": "macOS-12.1-arm64-arm-64bit", "system": "Darwin", "cpu_count": 8, "memory": 17179869184, "processor": "arm", "threads": 2, "run_date": "29/03/2022 10:20:15", "total_time": 469.13170886039734, "row_count_perf": 1124692412, "row_count_acq": 19144929, "max_memory_usage": 1727.015625, "incremental_memory_usage": 723.265625, "sql": "WITH performance AS ( SELECT perf.loan_id, book.orig_date, perf.loan_age AS stmt_number, book.borrower_credit_score, perf.disposition_date, perf.current_actual_upb, strftime( strptime(perf.monthly_reporting_period, '%Y-%d-%m'), '%Y-%m' ) AS report_month, CASE WHEN perf.current_loan_delinquency_status > 1 THEN 1 ELSE 0 END AS dq30, CASE WHEN perf.current_loan_delinquency_status > 3 THEN 1 ELSE 0 END AS dq90, CASE WHEN perf.current_loan_delinquency_status > 6 THEN 1 ELSE 0 END AS dq180, CASE WHEN perf.zero_balance_code = '02' THEN 1 WHEN perf.zero_balance_code = '03' THEN 1 WHEN perf.zero_balance_code = '09' THEN 1 WHEN perf.zero_balance_code = '15' THEN 1 ELSE 0 END AS bad FROM \"eight/perf/*.parquet\" AS perf, ( SELECT loan_id, borrower_credit_score, str_split(orig_date, '/')[1] AS orig_date FROM \"eight/acq/*.parquet\" ) AS book WHERE perf.loan_id = book.loan_id ) SELECT agg.orig_date, agg.stmt_number, loans.loan_count, agg.avg_credit_score, agg.upb_sum, agg.dollar_bad FROM (SELECT orig_date, stmt_number, avg(borrower_credit_score) AS avg_credit_score, sum(CASE WHEN disposition_date IS NOT NULL THEN current_actual_upb ELSE 0 END) AS dollar_bad, sum(current_actual_upb) AS upb_sum FROM performance WHERE stmt_number >= 1 GROUP BY orig_date, stmt_number) AS agg, (SELECT str_split(orig_date, '/')[1] AS orig_year, count(loan_id) AS loan_count FROM \"eight/acq/*.parquet\" GROUP BY orig_year) AS loans WHERE agg.orig_date = loans.orig_year;"}, {"machine": "arm64", "version": "Darwin Kernel Version 21.2.0: Sun Nov 28 20:29:10 PST 2021; root:xnu-8019.61.5~1/RELEASE_ARM64_T8101", "platform": "macOS-12.1-arm64-arm-64bit", "system": "Darwin", "cpu_count": 8, "memory": 17179869184, "processor": "arm", "threads": 4, "run_date": "29/03/2022 10:31:14", "total_time": 658.5092990398407, "row_count_perf": 1124692412, "row_count_acq": 19144929, "max_memory_usage": 2012.09375, "incremental_memory_usage": 283.953125, "sql": "WITH performance AS ( SELECT perf.loan_id, book.orig_date, perf.loan_age AS stmt_number, book.borrower_credit_score, perf.disposition_date, perf.current_actual_upb, strftime( strptime(perf.monthly_reporting_period, '%Y-%d-%m'), '%Y-%m' ) AS report_month, CASE WHEN perf.current_loan_delinquency_status > 1 THEN 1 ELSE 0 END AS dq30, CASE WHEN perf.current_loan_delinquency_status > 3 THEN 1 ELSE 0 END AS dq90, CASE WHEN perf.current_loan_delinquency_status > 6 THEN 1 ELSE 0 END AS dq180, CASE WHEN perf.zero_balance_code = '02' THEN 1 WHEN perf.zero_balance_code = '03' THEN 1 WHEN perf.zero_balance_code = '09' THEN 1 WHEN perf.zero_balance_code = '15' THEN 1 ELSE 0 END AS bad FROM \"eight/perf/*.parquet\" AS perf, ( SELECT loan_id, borrower_credit_score, str_split(orig_date, '/')[1] AS orig_date FROM \"eight/acq/*.parquet\" ) AS book WHERE perf.loan_id = book.loan_id ) SELECT agg.orig_date, agg.stmt_number, loans.loan_count, agg.avg_credit_score, agg.upb_sum, agg.dollar_bad FROM (SELECT orig_date, stmt_number, avg(borrower_credit_score) AS avg_credit_score, sum(CASE WHEN disposition_date IS NOT NULL THEN current_actual_upb ELSE 0 END) AS dollar_bad, sum(current_actual_upb) AS upb_sum FROM performance WHERE stmt_number >= 1 GROUP BY orig_date, stmt_number) AS agg, (SELECT str_split(orig_date, '/')[1] AS orig_year, count(loan_id) AS loan_count FROM \"eight/acq/*.parquet\" GROUP BY orig_year) AS loans WHERE agg.orig_date = loans.orig_year;"}, {"machine": "arm64", "version": "Darwin Kernel Version 21.2.0: Sun Nov 28 20:29:10 PST 2021; root:xnu-8019.61.5~1/RELEASE_ARM64_T8101", "platform": "macOS-12.1-arm64-arm-64bit", "system": "Darwin", "cpu_count": 8, "memory": 17179869184, "processor": "arm", "threads": 6, "run_date": "29/03/2022 10:55:06", "total_time": 1432.1898849010468, "row_count_perf": 1124692412, "row_count_acq": 19144929, "max_memory_usage": 1998.25, "incremental_memory_usage": 224.453125, "sql": "WITH performance AS ( SELECT perf.loan_id, book.orig_date, perf.loan_age AS stmt_number, book.borrower_credit_score, perf.disposition_date, perf.current_actual_upb, strftime( strptime(perf.monthly_reporting_period, '%Y-%d-%m'), '%Y-%m' ) AS report_month, CASE WHEN perf.current_loan_delinquency_status > 1 THEN 1 ELSE 0 END AS dq30, CASE WHEN perf.current_loan_delinquency_status > 3 THEN 1 ELSE 0 END AS dq90, CASE WHEN perf.current_loan_delinquency_status > 6 THEN 1 ELSE 0 END AS dq180, CASE WHEN perf.zero_balance_code = '02' THEN 1 WHEN perf.zero_balance_code = '03' THEN 1 WHEN perf.zero_balance_code = '09' THEN 1 WHEN perf.zero_balance_code = '15' THEN 1 ELSE 0 END AS bad FROM \"eight/perf/*.parquet\" AS perf, ( SELECT loan_id, borrower_credit_score, str_split(orig_date, '/')[1] AS orig_date FROM \"eight/acq/*.parquet\" ) AS book WHERE perf.loan_id = book.loan_id ) SELECT agg.orig_date, agg.stmt_number, loans.loan_count, agg.avg_credit_score, agg.upb_sum, agg.dollar_bad FROM (SELECT orig_date, stmt_number, avg(borrower_credit_score) AS avg_credit_score, sum(CASE WHEN disposition_date IS NOT NULL THEN current_actual_upb ELSE 0 END) AS dollar_bad, sum(current_actual_upb) AS upb_sum FROM performance WHERE stmt_number >= 1 GROUP BY orig_date, stmt_number) AS agg, (SELECT str_split(orig_date, '/')[1] AS orig_year, count(loan_id) AS loan_count FROM \"eight/acq/*.parquet\" GROUP BY orig_year) AS loans WHERE agg.orig_date = loans.orig_year;"}, {"machine": "arm64", "version": "Darwin Kernel Version 21.2.0: Sun Nov 28 20:29:10 PST 2021; root:xnu-8019.61.5~1/RELEASE_ARM64_T8101", "platform": "macOS-12.1-arm64-arm-64bit", "system": "Darwin", "cpu_count": 8, "memory": 17179869184, "processor": "arm", "threads": 8, "run_date": "29/03/2022 10:57:10", "total_time": 123.47633218765259, "row_count_perf": 1124692412, "row_count_acq": 19144929, "max_memory_usage": 1992.703125, "incremental_memory_usage": 122.1875, "sql": "WITH performance AS ( SELECT perf.loan_id, book.orig_date, perf.loan_age AS stmt_number, book.borrower_credit_score, perf.disposition_date, perf.current_actual_upb, strftime( strptime(perf.monthly_reporting_period, '%Y-%d-%m'), '%Y-%m' ) AS report_month, CASE WHEN perf.current_loan_delinquency_status > 1 THEN 1 ELSE 0 END AS dq30, CASE WHEN perf.current_loan_delinquency_status > 3 THEN 1 ELSE 0 END AS dq90, CASE WHEN perf.current_loan_delinquency_status > 6 THEN 1 ELSE 0 END AS dq180, CASE WHEN perf.zero_balance_code = '02' THEN 1 WHEN perf.zero_balance_code = '03' THEN 1 WHEN perf.zero_balance_code = '09' THEN 1 WHEN perf.zero_balance_code = '15' THEN 1 ELSE 0 END AS bad FROM \"eight/perf/*.parquet\" AS perf, ( SELECT loan_id, borrower_credit_score, str_split(orig_date, '/')[1] AS orig_date FROM \"eight/acq/*.parquet\" ) AS book WHERE perf.loan_id = book.loan_id ) SELECT agg.orig_date, agg.stmt_number, loans.loan_count, agg.avg_credit_score, agg.upb_sum, agg.dollar_bad FROM (SELECT orig_date, stmt_number, avg(borrower_credit_score) AS avg_credit_score, sum(CASE WHEN disposition_date IS NOT NULL THEN current_actual_upb ELSE 0 END) AS dollar_bad, sum(current_actual_upb) AS upb_sum FROM performance WHERE stmt_number >= 1 GROUP BY orig_date, stmt_number) AS agg, (SELECT str_split(orig_date, '/')[1] AS orig_year, count(loan_id) AS loan_count FROM \"eight/acq/*.parquet\" GROUP BY orig_year) AS loans WHERE agg.orig_date = loans.orig_year;"}]
