[{"machine": "arm64", "version": "Darwin Kernel Version 21.4.0: Mon Feb 21 20:35:58 PST 2022; root:xnu-8020.101.4~2/RELEASE_ARM64_T6000", "platform": "macOS-12.3-arm64-arm-64bit", "system": "Darwin", "cpu_count": 10, "memory": 34359738368, "processor": "arm", "threads": 10, "run_date": "29/03/2022 13:40:24", "total_time": 104.0458197593689, "row_count_perf": 1851966762, "row_count_acq": 34779856, "max_memory_usage": 3269.421875, "incremental_memory_usage": 1385.296875, "sql": "WITH performance AS ( SELECT perf.loan_id, book.orig_date, perf.loan_age AS stmt_number, book.borrower_credit_score, perf.disposition_date, perf.current_actual_upb, strftime( strptime(perf.monthly_reporting_period, '%Y-%d-%m'), '%Y-%m' ) AS report_month, CASE WHEN perf.current_loan_delinquency_status > 1 THEN 1 ELSE 0 END AS dq30, CASE WHEN perf.current_loan_delinquency_status > 3 THEN 1 ELSE 0 END AS dq90, CASE WHEN perf.current_loan_delinquency_status > 6 THEN 1 ELSE 0 END AS dq180, CASE WHEN perf.zero_balance_code = '02' THEN 1 WHEN perf.zero_balance_code = '03' THEN 1 WHEN perf.zero_balance_code = '09' THEN 1 WHEN perf.zero_balance_code = '15' THEN 1 ELSE 0 END AS bad FROM \"16_year_data/perf/*.parquet\" AS perf, ( SELECT loan_id, borrower_credit_score, str_split(orig_date, '/')[1] AS orig_date FROM \"16_year_data/acq/*.parquet\" ) AS book WHERE perf.loan_id = book.loan_id ) SELECT agg.orig_date, agg.stmt_number, loans.loan_count, agg.avg_credit_score, agg.upb_sum, agg.dollar_bad FROM (SELECT orig_date, stmt_number, avg(borrower_credit_score) AS avg_credit_score, sum(CASE WHEN disposition_date IS NOT NULL THEN current_actual_upb ELSE 0 END) AS dollar_bad, sum(current_actual_upb) AS upb_sum FROM performance WHERE stmt_number >= 1 GROUP BY orig_date, stmt_number) AS agg, (SELECT str_split(orig_date, '/')[1] AS orig_year, count(loan_id) AS loan_count FROM \"16_year_data/acq/*.parquet\" GROUP BY orig_year) AS loans WHERE agg.orig_date = loans.orig_year;"}]